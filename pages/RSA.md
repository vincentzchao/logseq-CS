tags:: #[[Asymmetric Encryption]]

- ---
- ## RSA数学原理
	- 参考：
		- 1. 阮一峰：https://www.ruanyifeng.com/blog/2013/06/rsa_algorithm_part_one.html
		- 2. 阮一峰：https://www.ruanyifeng.com/blog/2013/07/rsa_algorithm_part_two.html
		- 3. RSA密钥长度、明文长度和密文长度: https://cloud.tencent.com/developer/article/1199963
	-
	- ### 密钥组成
		- 公钥指数 e
		- 私钥指数 d
		- 模值 n
		- **公钥** = 公钥指数 e + 模值 n
		- **私钥** = 私钥指数 d + 模值 n
		-
	- ### 密钥长度
		- 一般指的是 **模值 n** 的长度，主流值：1024、2048、3072、4096 (其中1024目前基本安全，2048及以上特别安全。
	- ### 模值
		- **模值** 是通过素数生成器生成的，只需指定秘钥长度即可随机生成。
		- 实际长度不一定会等于 **指定的长度** ，但是会在这个长度附近。
	- ### 公钥指数
		- **公钥指数** 是 **随意选** 的。
		- 目前行业普遍选择 **PKCS#1** 的建议值:  `65537 (0x10001，5bits)` ，它是除了 `1、3、5、17、257` 之外的最小素数。
		- 之所以不选大一点的数，是为了节省 **公钥加密的时间** 。
	- ### 私钥指数
		- 私钥指数 是根据公式算出来的。
	- ### 明文长度
		- RSA算法可以加密的明文长度 m，必须满足 `0 < m <= n` 。
		- 如果 `m = 0` ，则RSA加密器会返回 **全 0** 的结果。
		- 如果 `m > n` ，运算会出错，所以需要 **分段加密** 。
		- 如果 `m < n` ，为了正确处理，需要用到 padding 。
	- ### Padding
		- 常用的 padding 标准有：NoPPadding、OAEPPadding、PKCS1Padding 。
		- 其中 `PKCS#1` 建议的 padding 为 **11字节** 。
		- 由于 padding 的部分也需要参与加密，所以 `实际可以加密的明文长度 = n / 8 - 11` ( 如果 n = 1024 bits，则实际可以加密的密文长度 = 1024 / 8 - 11 = 128 - 11 = 117 ) 。
	- ### 密文长度
		- 因为RSA限制了可加密明文的长度，所以密文长度是固定的，与 n 相等。
-